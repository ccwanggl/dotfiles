#!/usr/bin/env bash

# ====== Tiling settings =======================

yabai -m config layout                      bsp
#yabai -m config --space 2 layout            float

# New window spawn to the left of vertical, or top if horizontal split.
#yabai -m config window_placement first_child

# New window spawn to the right of vertical, or bottom if horizontal split.
yabai -m config window_placement second_child

yabai -m config top_padding                 20
yabai -m config bottom_padding              20
yabai -m config left_padding                20
yabai -m config right_padding               20
yabai -m config window_gap                  10


# ====== Mouse settings =======================

yabai -m config mouse_follows_focus         on
yabai -m config focus_follows_mouse         off

yabai -m config mouse_modifier              alt

# set modifier + left-click drag to move window
yabai -m config mouse_action1               move

# set modifier + right-click drag to move window
yabai -m config mouse_action2               resize

# ====== Window modifications settings =======================

# floating windows are always on top (default: off)
yabai -m config window_topmost              off
# modify window shadows (on/off/float)
yabai -m config window_shadow               on


yabai -m config window_opacity              on
yabai -m config window_opacity_duration     0.0
yabai -m config active_window_opacity       1.0
yabai -m config normal_window_opacity       0.9


# ====== Split ratios =======================

yabai -m config auto_balance                off
yabai -m config split_ratio                 0.5

# ====== Border settings =======================

yabai -m config window_border               on
yabai -m config window_border_width         4
yabai -m config active_window_border_color  0xffd75f5f
yabai -m config insert_window_border_color  0xff505050
yabai -m config normal_window_border_color  0xff775759


# updates every 5 minutes
frequency=300

function update_battery_loop() {
	while true; do
		# Get the current battery percentage.
		battery=$(pmset -g batt | grep -Eo "\d+%" | cut -d% -f1)

		if [ $battery -gt 84 ]; then
			yabai -m config status_bar_power_icon_strip battery-full plug
		elif [ $battery -gt 60 ]; then
			yabai -m config status_bar_power_icon_strip battery-three-quarters plug
		elif [ $battery -gt 39 ]; then
			yabai -m config status_bar_power_icon_strip battery-half plug
		elif [ $battery -gt 14 ]; then
			yabai -m config status_bar_power_icon_strip battery-quarter plug
		else
			yabai -m config status_bar_power_icon_strip battery-empty plug
		fi

		sleep $frequency
	done
}


echo "yabai configuration loaded ..."

